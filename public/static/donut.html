<html>
   <head>
      <script type = "text/javascript" src = "https://d3js.org/d3.v7.min.js"></script>
      <style>
      </style>
    </head>
  <body>
    <div>
        <svg id="donut" width=500 height=500>
        </svg>
    </div>
    <script type="text/javascript">
        const svg    = d3.select('svg#donut')
        const width  = svg.node().getBoundingClientRect().width
        const height = svg.node().getBoundingClientRect().height
        const margin = 40

        const radius = Math.min(width, height) / 2 - margin

        const donut_data = [{name: "Artiste", count: 50}, {name: "Association", count: 25}, {name: "Entreprise", count: 4}, {name: "Autre", count: 1}]
        const color = d3.scaleOrdinal()
            .domain(donut_data.map(d => d.name))
            .range(d3.schemeDark2)

        const pieArcData = d3.pie()
            .value(d => d.count)(donut_data)
        const arc = d3.arc()
            .innerRadius(radius * 0.5)
            .outerRadius(radius * 0.8)
            .padRadius(200)
            .padAngle(5/300)

        svg.attr('viewBox', [-width / 2, -height / 2, width, height])
            .append('g')
              .selectAll('path')
              .data(pieArcData)
              .enter()
              .append('path')
                .attr('d', (d) => arc(d))
                .attr('fill', (d) => color(d.data.name))

        svg.append('g')
          .attr("font-family", "sans-serif")
          .attr("font-size", 26)
          .attr("text-anchor", "middle")
          .selectAll('text')
          .data(pieArcData)
          .enter()
          .append('text')
            .attr('transform', (d) => `translate(${arc.centroid(d).join(',')})`)
            .attr('fill', "white")
            .attr('stroke', 'black')
            .attr('stroke-width', '1')
            .text((d) => d.data.name+' : \n'+d.data.count)

    </script>
  </body>
</html>
